# asp.net adv project xdddd

Репозиторий для выполнения задания по дисциплине Advanced Backend  
<https://docs.google.com/document/d/1zzG605ATbEeBQG4iJzCY8D-JS_mtqAzFhRDnc9j6AcE/edit?usp=sharing>

## Как запустить

**СУБД**: PostgreSQL  
**Брокер сообщений**: RabbitMQ  

В среде перед запуском необходимо указать переменные... (а можно и не указать, они и так вбиты в launchSettings.json каждого проекта)  

Для JWT токена:

```bash
ASPNETCORE_JWT_ISSUER
ASPNETCORE_JWT_AUDIENCE
ASPNETCORE_JWT_LIFETIME
ASPNETCORE_JWT_KEY
```

Подключения к БД (строка, содержащая: хост, порт, имя бд, юзера, пароль):

```bash
ASPNETCORE_BACKEND_DB_CONNECTION
ASPNETCORE_AUTH_DB_CONNECTION
```

Подключение к брокеру (только хост):

```bash
ASPNETCORE_RABBIT_CONNECTION
```

## Шо есть?

Везде и повсюду:  

1. n-layer архитектура ( разбиение на api, bll, dal(где пригождается) )
2. Вынесенные в среду (четверег, хахахахаха) конфиги (см. ['Как запустить'](#как-запустить))

### Auth

Сделано все, из особенного: refresh + сброс пароля  

### Backend

Из особенного:  

1. Фиксирование цен позиций на момент заказа
2. Возможность оформить заказы, имея позиции из разных ресторанов (создается несколько заказов на каждый ресторан)  
3. Показ изчезнувших позиций при оформлении заказа и\или просмотра корзины (возвращается в кач-ве списка айдишников отдельным полем в ответе)
4. Возможность CRUDить меню ресторана, задать его активность (вкл\выкл отображение его юзеру), вносить в него блюда (которые так же можно CRUDить в ресторан)  
5. Отправка оповещений при смене статуса заказа (см. [Notifications](#notifications))  
6. Resource-based авторизация - проверка на наличие отношения между сущностью и тем, кто ее запрашивает (заказ-юзер, заказ-повар, и т.п.)  

### AdminPanel

Особенное?:

1. Использование авто-маппера
2. Усиленное использование PartialView (с днем модалки)
3. Авторизация через Cookies
4. Офигенный вывод ошибок бизнес-логики путем редиректа на отдельную fucking страницу (превосходство ui дизайна)
5. Кнопка About (нажмите - узнаете)

### Notifications

Оно читает сообщения из Рэббита (без EasyNetQ) и плюется им в клиент, чего еще тебе\вам тут надо?

### Другое

1. Использование кастомных фильтров для авторизации по ролям
2. Работа с пакетом Identity
3. Кастомные Middleware
4. Кастомные исключения (один)
